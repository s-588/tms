package tables

import (
	"fmt"
	"github.com/s-588/tms/models"
	. "github.com/s-588/tms/static/template/components"
)

// Generic table template
templ GenericTable(entityType, singularName string, items []any, columns []TableColumn,
	limit, offset, totalCount int, filter models.Filter, renderRow func(any) templ.Component) {
	<div class="box">
		@OperationsBar(entityType, singularName, filter)
		<!-- Table -->
		<div class="table-container" id={ entityType + "-table" }>
			<table class="table is-fullwidth is-striped is-hoverable">
				@TableHeader(columns, filter.GetSortBy(), filter.GetSortOrder(), "/"+entityType)
				<tbody>
					if len(items) == 0 {
						@EmptyState(getEntityIcon(entityType), fmt.Sprintf("No %s found", entityType))
					} else {
						for _, item := range items {
							@renderRow(item)
						}
					}
				</tbody>
			</table>
		</div>
		if totalCount > 0 {
			@Pagination("/"+entityType, totalCount, limit, offset, filter)
		}
	</div>
}

func getEntityIcon(entityType string) string {
	icons := map[string]string{
		"clients":    "fa-users",
		"employees":  "fa-user-tie",
		"fuels":      "fa-gas-pump",
		"orders":     "fa-box",
		"prices":     "fa-tag",
		"transports": "fa-truck",
	}
	if icon, ok := icons[entityType]; ok {
		return icon
	}
	return "fa-table"
}
